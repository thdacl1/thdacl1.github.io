<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Demo Chat AI</title>
  <link rel="stylesheet" href="styles.css">
  <script>
    // Hàm gửi yêu cầu tới API Novita AI
    async function getAIResponse(userInput) {
      const apiUrl = "https://api.novita.ai/v3/openai/chat/completions";
      const apiKey = "sk_XUEQztNwoL_vDz7R-IMYcPQRCfbNCfx2hn_MWORs_Hg";  // Thay thế bằng API Key của bạn

      const requestPayload = {
        model: "deepseek/deepseek-r1",
        messages: [
          { role: "system", content: "Be a helpful assistant" },
          { role: "user", content: userInput }
        ],
        response_format: { type: "text" },
        max_tokens: 2048,
        temperature: 0.6,
        top_p: 1,
        min_p: 0,
        top_k: 50,
        presence_penalty: 0,
        frequency_penalty: 0,
        repetition_penalty: 1
      };

      const response = await fetch(apiUrl, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": `Bearer ${apiKey}`
        },
        body: JSON.stringify(requestPayload)
      });

      if (response.ok) {
        const data = await response.json();
        return data.choices[0].message.content;  // Lấy nội dung phản hồi từ API
      } else {
        console.error("Lỗi khi gọi API:", response.statusText);
        return "Có lỗi xảy ra, vui lòng thử lại!";
      }
    }

    // Xử lý sự kiện gửi tin nhắn
    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('chat-form').addEventListener('submit', async function (e) {
        e.preventDefault();

        // Lấy nội dung người dùng nhập
        const userInput = document.getElementById('user-input').value;

        if (userInput.trim()) {
          // Hiển thị tin nhắn của người dùng trong giao diện
          const userMessage = document.createElement('div');
          userMessage.textContent = `Bạn: ${userInput}`;
          document.querySelector('.message-wrap').appendChild(userMessage);

          // Gửi yêu cầu tới API Novita AI và nhận phản hồi
          const aiResponse = await getAIResponse(userInput);

          // Hiển thị phản hồi của AI trong giao diện
          const botResponse = document.createElement('div');
          botResponse.textContent = `AI: ${aiResponse}`;
          document.querySelector('.message-wrap').appendChild(botResponse);

          // Xóa ô nhập liệu
          document.getElementById('user-input').value = '';
        }
      });
    });
  </script>
</head>
<body>
  <div class="chat-demo">
    <div class="chat-box" style="height: 600px;">
      <div class="message-wrap">
        <div class="message-inner" style="width: 486px;"></div>
      </div>
      <div class="footer" style="width: 502px; transform: translateY(-229px);">
        <div class="footer-msg-info">
          <span class="flex flex-col items-center justify-center gap-2">
            <img alt="Logo AI" loading="lazy" width="40" height="40" src="deepseek-logo.png">
            <span>Thử nghiệm deepseek/deepseek-r1</span>
          </span>
        </div>
        <form class="footer-form" style="background: rgb(255, 255, 255); cursor: auto; width: 502px;" id="chat-form">
          <div class="footer-opt">
            <div class="input-wrap" style="padding: 13px 10px; width: 502px;">
              <textarea id="user-input" class="input" placeholder="Hãy nói gì đó..." rows="1" style="max-height: 200px; cursor: auto; height: 24px;"></textarea>
            </div>
            <button type="submit" class="send-btn" id="send-btn">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z"></path>
                <path d="M6 12h16"></path>
              </svg>
            </button>
          </div>
        </form>
        <div class="options">
          <button class="opt-btn">Nhập nhân vật</button>
          <button class="opt-btn">Xóa lịch sử</button>
          <button class="opt-btn settings-btn">
            <span class="icon-settings"></span>
          </button>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
