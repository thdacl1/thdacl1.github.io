<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Demo Chat AI</title>
  <style>
    /* Bạn có thể thêm CSS tùy chỉnh ở đây để bố cục đẹp hơn */
    .chat-box { max-width: 600px; margin: 20px auto; border: 1px solid #ccc; padding: 20px; }
    .message-wrap { margin-bottom: 20px; }
    .input { width: 100%; padding: 10px; font-size: 14px; }
    .send-btn { padding: 10px 20px; background-color: #4CAF50; color: white; cursor: pointer; }
    .send-btn:hover { background-color: #45a049; }
  </style>
</head>
<body>
  <div class="chat-demo">
    <div class="chat-box" style="height: 600px;">
      <div class="message-wrap">
        <!-- Tin nhắn sẽ được hiển thị ở đây -->
      </div>
      <div class="footer" style="width: 502px; transform: translateY(-229px);">
        <form class="footer-form" id="chat-form">
          <div class="footer-opt">
            <div class="input-wrap" style="padding: 13px 10px; width: 502px;">
              <textarea id="user-input" class="input" placeholder="Hãy nói gì đó..." rows="1"></textarea>
            </div>
            <button type="submit" class="send-btn" id="send-btn">Gửi</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script>
    // Hàm gửi yêu cầu tới API Novita AI
    async function getAIResponse(userInput) {
      const apiUrl = "https://api.novita.ai/v3/openai/chat/completions";
      const apiKey = "sk_XUEQztNwoL_vDz7R-IMYcPQRCfbNCfx2hn_MWORs_Hg";  // Thay thế bằng API Key của bạn

      const requestPayload = {
        model: "deepseek/deepseek-r1",
        messages: [
          { role: "system", content: "Be a helpful assistant" },
          { role: "user", content: userInput }
        ],
        response_format: { type: "text" },
        max_tokens: 2048,
        temperature: 0.6,
        top_p: 1,
        min_p: 0,
        top_k: 50,
        presence_penalty: 0,
        frequency_penalty: 0,
        repetition_penalty: 1
      };

      const response = await fetch(apiUrl, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": `Bearer ${apiKey}`
        },
        body: JSON.stringify(requestPayload)
      });

      if (response.ok) {
        const data = await response.json();
        return data.choices[0].message.content;  // Lấy nội dung phản hồi từ API
      } else {
        console.error("Lỗi khi gọi API:", response.statusText);
        return "Có lỗi xảy ra, vui lòng thử lại!";
      }
    }

    // Xử lý sự kiện gửi tin nhắn
    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('chat-form').addEventListener('submit', async function (e) {
        e.preventDefault();

        // Lấy nội dung người dùng nhập
        const userInput = document.getElementById('user-input').value;

        if (userInput.trim()) {
          // Hiển thị tin nhắn của người dùng trong giao diện
          const userMessage = document.createElement('div');
          userMessage.textContent = `Bạn: ${userInput}`;
          document.querySelector('.message-wrap').appendChild(userMessage);

          // Gửi yêu cầu tới API Novita AI và nhận phản hồi
          const aiResponse = await getAIResponse(userInput);

          // Hiển thị phản hồi của AI trong giao diện
          const botResponse = document.createElement('div');
          botResponse.textContent = `AI: ${aiResponse}`;
          document.querySelector('.message-wrap').appendChild(botResponse);

          // Xóa ô nhập liệu
          document.getElementById('user-input').value = '';
        }
      });
    });
  </script>
</body>
</html>
